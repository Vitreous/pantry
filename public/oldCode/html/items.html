<html>
<head>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

  <script>
    $(document).ready(function(){
      $.ajax({
        url: '/api/items',
        type: 'GET',
        success: function(response){
            if (response.items.length) {
              var Options = "<tr><th>Name</th><th>Quantity</th><th>Modify</th><th>Delete</th></tr>";
              for(var i = 0;i < response.items.length; i++) {
                Options += "<tr><td>" + response.items[i].name + "</td><td>" +
                response.items[i].quantity + "</td><td><button type='button'>Edit Me!</button></td>" +
                "<td><button type=\"button\" onclick=\"deleteItem(\'" + response.items[i]._id + "\')\">Delete Me!</button></td></tr>";
                };
              } else {
                var Options = "You have no items in your Pantry"
              }
            $("#itemTable").html(Options);
            }
        });
    });

    function deleteItem(value){
      console.log(value + " from deleteItem function")
      $.ajax({
      url: "/api/items/" + value,
      type: 'DELETE',
      success: function(response){
        $.ajax({
          url: '/api/items',
          type: 'GET',
          success: function(response){
              if (response.items.length) {
                var Options = "<tr><th>Name</th><th>Quantity</th><th>Modify</th><th>Delete</th></tr>";
                for(var i = 0;i < response.items.length; i++) {
                  Options += "<tr><td>" + response.items[i].name + "</td><td>" +
                  response.items[i].quantity + "</td><td><button type='button'>Edit Me!</button></td>" +
                  "<td><button type=\"button\" onclick=\"deleteItem(\'" + response.items[i]._id + "\')\">Delete Me!</button></td></tr>";
                  };
                } else {
                  var Options = "You have no items in your Pantry"
                }
              $("#itemTable").html(Options);
              }
          });
          }
      });
    };

  </script>
</head>

<body>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <ul class="nav navbar-nav">
        <li><a class="navbar-brand" href="/api/index">Home</a></li>
        <li><a href='/api/itemspage'>View Items</a></li>
        <li><a href='/api/recipespage'>View Recipes</a></li>
        <li><a href='/api/viewShoppingList'>Manage Shopping List</a></li>
        <li style="float:right"><a href='/api/userprofile'>User Profile</a></li>
      </ul>
    </div>
  </nav>

<h2>View contents of your Pantry - items.html CRuD</h2>

<hr />

<table style="width:50%" id="itemTable">
</table>

<form method="POST" action="/api/items">
  <fieldset>
    <legend>Add a new item:</legend>
    Name:<br>
    <input type="text" name="name"><br>
    Quantity:<br>
    <input type="text" name="quantity"><br><br>
    <input type="submit" value="Submit">
  </fieldset>
</form>

<table class="table table-bordered table-dark table-striped" id="test">
</table>

</body>

</html>
