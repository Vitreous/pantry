<!DOCTYPE html>
<html>
<head>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

  <script>
    $(document).ready(function(){
        $.ajax({
          url: '/api/items',
          type: 'GET',
          //data: 'page=' + btn_page,
            success: function (itemResponse) {
              //TODO Account for quantity
              //Creates a list for items
              var itemList =[];
              for (var i = 0;i < itemResponse.items.length; i++) {
                itemList.push(itemResponse.items[i].name);
              }
              $.ajax({
                    url: '/api/recipes',
                    type: 'GET',
                    //data: 'page=' + a,
                    success: function (recipes) {
                      var webtxt = "";
                      for (var i = 0;i < recipes.recipes.length; i++) {
                        webtxt += "<h4><b>" + recipes.recipes[i].name + "</b></h4>";
                        var flag = true;
                        for(var j = 0; j < recipes.recipes[i].ingredients.length; j++) {
                          //console.log(recipes.recipes[i].ingredients[j]);

                          if(!itemList.includes(recipes.recipes[i].ingredients[j])){
                            //console.log("Do not have " + recipes.recipes[i].ingredients[j]);
                            flag = false;
                            };
                          };

                          if(!flag){
                            webtxt += "You cannot cook " + recipes.recipes[i].name
                          } else {
                            webtxt += "You can cook " + recipes.recipes[i].name
                          }
                          webtxt += "<br/><button type=\"button\" onClick=\"cookRecipe(\'" + recipes.recipes[i]._id + "\')\">Cook Me</button>"
                      }
                      $("#display").html(webtxt);
                    }
                });
            }
          });

        $.ajax({
          url: '/api/recipes',
          type: 'GET',
          success: function(response){    // response contains json object in i
              var Options = "";
              for(var i = 0;i < response.recipes.length; i++) {
                Options += "<p><h4>" + response.recipes[i].name + "</h4>" +
                "<b>Ingredients</b><ul>";
                for(var j = 0; j < response.recipes[i].ingredients.length; j++) {
                  Options += "<li>" + response.recipes[i].ingredients[j] + "</li>";
                };
                Options += "</ul></p><hr/>"
              };
              $("#recipes").html(Options);
              }
          });
      });

      function cookRecipe(value){
        $.ajax({
          url: '/api/recipe/' + value,
          type: 'GET',
          success: function(response){    // response contains json object in i
              var itemList = response.recipe.ingredients
              $.ajax({
                url: '/api/items',
                type: 'GET',
                success: function(response){
                    for(var i = 0;i < response.items.length; i++) {
                      if(itemList.includes(response.items[i].name)){
                        $.ajax({
                          url: '/api/items/' + response.items[i]._id,
                          type: 'DELETE',
                          success: function(response){}
                          });
                        }
                      };
                    }
                });
                document.location.reload();
              }
          });
      };

</script>
</head>

<body>

<%- include('partials/header'); %>

<h2>Welcome <%= user.name %></h2>
<h2>Index | What you can't cook now</h2>

<hr />

<div>
  <span id="display">
  </span>
</div>

<table class="table table-bordered table-dark table-striped" id="test">

</table>

40 Hours <br/>

<hr/>

Development CI/CD</br></br>

<ul>

  <li><i>8am - 8.30am</i></li>
  <li>Document</li>

  <li><i>8.30am - 9am</i></li>
  <li>Document</li>

  <li><i>9am - 9.30am</i></li>
  <li>Document</li>

  <li><i><b>10am - 1.30pm Gap</b></i></li>

  <li><i>1.30pm - 2pm</i></li>
  <li>Bootstrap</li>

  <li><i>2pm - 2.30pm</i></li>
  <li>Bootstrap</li>

  <li><i>2.30pm - 3pm</i></li>
  <li>Bootstrap</li>

</ul>

Report docs.google.com</br></br>

<ul>

  <li><b>10 Hr Plan           </b></li>
  <li><b>Items Page           </b></li>
  <li><b>Recipe Page          </b></li>
  <li><b>Extra - Recipes      </b></li>
  <li><b>HomePage formula 1/3 </b></li>
  <li><b>HomePage formula 2/3 </b></li>
  <li><b>HomePage formula 3/3 </b></li>
  <li><b>Extra - Recipes      </b></li>
  <li><b>Extra - Recipes      </b></li>
  <li><b>Login 1/2            </b></li>
  <li><b>.5 Hour Meeting Prep </b></li>
  <li><b>20 Hr Plan           </b></li>
  <li><b>Cognito Research     </b></li>
  <li><b>Login 2/2            </b></li>
  <li><b>Login working        </b></li>
  <li><b>Delete Functionality of items </b></li>
  <li><b>Code Cleanup</b></li>
  <li><b>CookRecipe Function 1/x</b></li>
  <li><b>CookRecipe Function 2/x</b></li>
  <li><b>CookRecipe Function 3/x</b></li>
  <li><b>Jenkins</b></li>
  <li><b>Jenkins Webhooks</b></li>
  <li><b>Jenkins Webhook troubleshooting</b></li>
  <li><b>Jenkins SSH configuration</b></li>
  <li><b>Jenkins CI configuration</b></li>
  <li><b>Jenkins CI configuration</b></li>
  <li><b>Jenkins CI configuration</b></li>
  <li><b>git branch set up</b></li>
  <li><b>CookRecipe function</b></li>
  <li><b>CookRecipe function</b></li>
  <li><b>CookRecipe function merged</b></li>
  <li><b>Login 1/4 AWS Amplify</b></li>
  <li><b>Login 2/4 AWS Amplify</b></li>
  <li><b>Jenkins</b></li>
  <li><b>Jenkins</b></li>
  <li><b>Jenkins</b></li>
  <li><b>Jenkins</b></li>
  <li><b>.5 Hour Meeting Prep</b></li>
  <li><b>AWS & CI/CD 1/4 Research</b></li>
  <li><b>AWS & CI/CD 2/4 Docker research</b></li>
  <li><b>AWS & CI/CD 3/4 Docker file research</b></li>
  <li><b>AWS & CI/CD 4/4 Site running in docker container</b></li>
  <li><b>Jenkins 1/2</b></li>
  <li><b>CodeDeploy Research</b></li>
  <li><b>Testing 1/2</b></li>
  <li><b>Testing 2/2</b></li>
  <li><b>Bootstrap</b></li>
  <li><b>Login</b></li>
  <li><b>Login</b></li>
  <li><b>Login UI</b></li>
  <li><b>Login UI</b></li>
  <li><b>Login UI</b></li>
  <li><b>Login UI</b></li>
  <li><b>Login Unique ID</b></li>
  <li><b>Login Unique ID</b></li>


  <li><b>Document 1/6</b></li>
  <li><b>Document 2/6</b></li>
  <li><b>Document 3/6</b></li>
  <li><b>Sun - Document</b></li>
  <li><b>Sun - Document</b></li>
  <li><b>Mon - Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>
  <li><b>Document</b></li>

</ul>
</body>

</html>
